---
date: 2024-10-02
tags:
  - Онлайн-школа
---
# ImgproxyModule

Модуль предназначен для проксирования и размытия изображений.

## ImgproxyController

В контроллере применяются следующие проверки:

- JWTGuard - проверят на валидность токен для доступа к методам

***

### Endpoints

Контроллер предоставляет следующий эндпоинт:

| Метод | URL         | Описание                             |
| ----- | ----------- | ------------------------------------ |
| GET   | `imgproxy/` | Проксирование и размытие изображения |

***

### Проксирование и размытие изображения

`GET imgproxy/`

*Входные данные:*

- Проверка наличия роли суперадминистратора (SuperAdminRoleGuard)
- Query параметр:

```json
{
  url: string
}
```

*Функционал:*

Для указанного изображения, генерируется новый URL размытого изображения, в котором содержится значение размытия (по умолчанию 25), а также создается HMAC-подпись. Для полученного URL сохраняется `contentType` и данные изображения в бинарном виде.

*Выходные данные:* Status: `200 OK`

Возвращает объект `response: Response`, содержащий заголовок с типом содержимого ответа `contentType`, и файл изображения в бинарном виде.

***

## Зависимости (импортируемые модули)

- HttpModule

***

## Используемый стэк

- JavaScript
- NestJS
- TypeScript
- Node.js