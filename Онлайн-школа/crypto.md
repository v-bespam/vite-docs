---
date: 2024-10-18
tags:
  - Онлайн-школа
---
# CryptoModule

Предназначен для работы с паролями и шифрованием данных. Модуль не предоставляет никаких эндпоинтов.

***

## CryptoService

Предоставляет следующие методы:

| Имя                         | Описание                                           |
| --------------------------- | -------------------------------------------------- |
| getPasswordHash             | Хэширование пароля                                 |
| generatePasswordData        | Подготовка данных для пароля                       |
| generateRandomString        | Создание случайной строки                          |
| generateRandomNumericString | Создание случайной строки, содержащей только цифры |
| encryptAES128CBC            | Шифрование данных при помощи AES                   |
| decryptAES128CBC            | Дешифрование данных при помощи AES                 |

***

### getPasswordHash

*Входные данные:*

```json
{
  password: string;
  salt: string;
}
```

*Функционал:*

Метод создаёт объект хеширования используя алгоритм SHA-256. Обновляет хеш с помощью строки, состоящей из указанных соли и пароля, разделённых двоеточием. Завершает хеширование и возвращает результат в виде шестнадцатеричной строки.

*Выходные данные:*

Возвращает хэшированный объект в виде шестнадцатеричной строки.

### generatePasswordData

*Входные данные:*

```json
{
  password: string;
  saltLength: number;
}
```

*Функционал:*

Метод генерирует соль указанной длины, хэш переданного пароля с учетом соли в шестнадцатеричном виде, и возвращает подготовленные данные.

*Выходные данные:* Status: `200 OK`

Возвращает объект, содержащий соль, хэш и пароль в строковом виде.

```json
{
  salt: string;
  hash: string;
  password: string
}
```

### generateRandomString

*Входные данные:*

```json
{
  length: number
}
```

*Функционал:*

Генерирует строковый объект указанной длины, состоящий из случайных символов пространства имен `Randomstring`.

*Выходные данные:*

Возвращает сгенерированный строковый объект указанной длины.

### generateRandomNumericString

*Входные данные:*

```json
{
  length: number
}
```

*Функционал:*

Аналогично [generateRandomString](#generateRandomString) генерирует строковый объект указанной длины, но состоящий только из случайных чисел.

*Выходные данные:*

Возвращает сгенерированный строковый объект указанной длины.

### encryptAES128CBC

*Входные данные:*

```json
{
  data: string;
  key: string;
}
```

*Функционал:*

Метод создает хеш SHA-512 переданного ключа, получает вектор инициализации и создает объект шифрования с использованием алгоритма AES-128 CBC, на основе ранее сгенерированного хэша ключа и вектора.

Шифрует данные, преобразуя их из формата UTF-8 в шестнадцатеричный формат. Завершает процесс шифрования, обрабатывая любые оставшиеся данные и присоединяет их.

*Выходные данные:*

Возвращает объект с результатом шифрования в виде одной строки.

### decryptAES128CBC

*Входные данные:*

```json
{
  encrypted: string;
  key: string;
}
```

*Функционал:*

Метод создает хеш SHA-512 переданного ключа, получает вектор инициализации и создает объект расшифровки с использованием алгоритма AES-128 CBC, на основе ранее сгенерированного хэша ключа и вектора.

Дешифрует данные, преобразуя их из шестнадцатеричного формата в UTF-8. Завершает процесс дешифрования, обрабатывая любые оставшиеся данные и присоединяет их.


*Выходные данные:* Status: `200 OK`

Возвращает объект с результатом дешифрования в виде одной строки.

***

## Используемый стэк

- JavaScript
- NestJS
- TypeScript
- Node.js