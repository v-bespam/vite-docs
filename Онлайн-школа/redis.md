---
date: 2024-10-21
tags:
  - Онлайн-школа
---
# RedisModule

Предназначен для работы с кэшем Redis. Модуль не предоставляет никаких эндпоинтов. Значение TTL по умолчанию - 86400 секунд (24 часа).

***

## RedisService

Предоставляет следующие методы:

| Имя              | Описание                                   |
| ---------------- | ------------------------------------------ |
| get              | Получение данных их кэша по ключу          |
| getKeysByPattern | Поиск ключей по шаблону                    |
| getMany          | Получение данных из кэша по массиву ключей |
| set              | Сохранение данных в кэше                   |
| setMany          | Сохранение массива данных в кэше           |
| del              | Удаление данных из кэша                    |
| reset            | Очистка кэша                               |
| removeByPattern  | Удаление ключей по шаблону                 |

***

### get

*Входные данные:*

```json
{
  key: string;
  params?: GetFromCacheParams(convertDates?: boolean);
}
```

*Функционал:*

Метод используется для поиска и получения значения из кэша Redis по указанному ключу. Если в параметрах вызова указано `convertDates: true` и найденное значение является объектом, преобразует дату формата ISO 8601 в объект `Date`.

*Выходные данные:*

Возвращает объект, полученный из кэша, либо `undefined`, если значение не было найдено.

### getKeysByPattern

*Входные данные:*

```json
{
  pattern: string
}
```

*Функционал:*

Метод получает все ключи из кэша, которые соответствуют заданному шаблону. Вызывает метод `keys` с переданным шаблоном.

*Выходные данные:*

Возвращает массив ключей, соответствующих переданному шаблону.

### getMany

*Входные данные:*

```json
{
  key: string[];
  params?: GetFromCacheParams(convertDates?: boolean);
}
```

*Функционал:*

Метод используется для поиска и получения значений из кэша Redis по указанному массиву ключей, из которого также удаляются дубликаты.

Если в параметрах вызова указано `convertDates: true` и найденные значения являются объектом или массивом, преобразует дату формата ISO 8601 в объект `Date`.

*Выходные данные:*

Возвращает массив значений, полученных из кэша, либо `undefined`, если значения не были найдены.

### set

*Входные данные:*

```json
{
  key: string;
  value: T;
  ttl?: number;
}
```

*Функционал:*

Метод сохраняет значение в кэше Redis с указанным ключом и временем жизни, если оно было передано.

*Выходные данные:*

Возвращает объект, содержащий значение, сохраненное в кэше.

### setMany

*Входные данные:*

- Массив данных RedisSetItem[]:

```json
{
  key: string;
  val: T;
}
```

*Функционал:*

Метод используется для сохранения массива данных в кэш Redis, из которого также удаляются дубликаты ключей.

*Выходные данные:* -

### del

*Входные данные:*

```json
{
  key: string;
}
```

*Функционал:*

Метод используется для поиска и удаления значения из кэша Redis по указанному ключу.

*Выходные данные:* -

### reset

*Входные данные:* -

*Функционал:*

Метод позволяет очистить кэш Redis.

*Выходные данные:* -

### removeByPattern

*Входные данные:*

```json
{
  pattern: string
}
```

*Функционал:*

Выполняет [поиск ключей по заданному шаблону](#getKeysByPattern), затем используя полученный массив, удаляет все ключи в кэше Redis.

*Выходные данные:* -

***

## Зависимости (импортируемые модули)

- CacheModule

***

## Используемый стэк

- JavaScript
- NestJS
- TypeScript
- Node.js