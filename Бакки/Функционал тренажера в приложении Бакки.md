---
date: 2024-09-20
tags:
  - qtim
---
Тренажер в мобильном приложении позволяет сотрудникам ресторана изучать позиции меню. Тесты в тренажере формируются автоматически на основании составленного в административной панели организации меню.

Пользователю необходимо авторизоваться в приложении Бакки под своим логином и паролем, перейти в раздел "Тренажер" и добавить отдельные позиции меню для изучения или целое меню.

## Описания флоу тренажера

- Пользователь нажимает на кнопку "Начать тренировку". В этот момент мобильное устройство используя сокеты отправляет событие на генерацию вопросов.
- После получения события на генерацию вопросов для конкретного пользователя, производится создание вопросов и направляется по уникальному идентификатору (случайный UUID) + ID пользователя в Redis. Затем пользователю направляется событие о том, что вопросы сгенерированы и можно их забирать. Получение данных осуществляется по REST API, где будет передаваться этот уникальный идентификатор.
- Пользователь получает вопросы и может приступить к прохождению теста.
- Когда пользователь отвечает на вопросы, данные будут отправляться при помощи REST API по следующему принципу: блюдо, тип вопроса, процент прохождения по этому типу вопроса. После получения этой информации необходимо обновить значение прогресса изучения блюда.
- Если пользователь закрыл телефон или случился разрыв соединения, то необходимо очистить Redis по ключу пользователя.

Функциональные требования:

Получение списка вопросов, прогресс должен сохраняться при прохождении. Если произошел разрыв соединения, то текущая генерация должна быть удалена.

## Типы вопросов теста

Тесты составляются из вопросов нескольких типов, при этом порядок вопросов в тесте должен быть всегда одинаков. Типы вопросов расположены в порядке увеличения сложности.

1. Изучи позицию - показаны фотография, название, ингредиенты и описание блюда. Предлагается изучить блюдо. Проценты прогресса за вопрос не начисляются, но отображаются в мобильном приложении.
2. Выбери ингредиенты - выбрать верный вариант со списком ингредиентов из предложенных. Показаны фотография и название
3. Выбери позицию по фото - отображается фотография блюда, необходимо выбрать верный вариант его названия
4. Выбери позицию по ингредиентам - отображается список ингредиентов, необходимо выбрать верный вариант названия блюда из предложенных
5. Вспомни ингредиенты (помню/не помню) - отображается фотография и название блюда, необходимо просто нажать на кнопку "Помню" или "Не помню"
	- В случае ответа "Не помню", будет предложено повторно изучить карточку блюда  
6. Найди верные ингредиенты - отображается фотография и название блюда, необходимо в предложенном списке отметить ингредиенты, относящиеся к позиции
7. Допиши ингредиенты - отображается фотография, название блюда, название меню. В списке ингредиентов допущены пропуски. Пользователю необходимо вручную написать названия недостающих ингредиентов
	- Пользователю не нужно соблюдать порядок ингредиентов блюда. Если продукт должен присутствовать в списке, он появится в поле
	- В случае, если была допущена ошибка, в пустых полях отображаются первые буквы верных ингредиентов. Если название ингредиента состоит из нескольких слов, первые буквы отображаются для каждого слова
	- Если ответ на вопрос не был дан, поля заполняются верным названием ингредиентов
8. Напиши все ингредиенты - пользователю необходимо вручную написать названия всех ингредиентов блюда, затем сверить их с верным списком и самостоятельно оценить свой ответ
9. Вспомни описание (помню/не помню) - отображается фотография, название блюда и название меню, необходимо просто нажать на кнопку "Помню" или "Не помню"
10. Напиши описание позиции своими словами - отображается фотография, название блюда, название меню. Необходимо вручную написать описание
	- После ответа на вопрос будет предложено сравнить введенное пользователем описание с описанием указанным на платформе. Далее пользователь должен оценить себя самостоятельно выбрав один из вариантов: "Хорошо знаю описание" или "Нужно повторить "

## Алгоритм составления вопросов в тестах тренажера

Вопросы теста в тренажере всегда показываются в строго определенном порядке. При этом вопросы с типами с 1 по 5 будут показаны во время первых трех запусков тренажера.

![[Pasted image 20240923180703.png]]
*Цифрами в таблице отмечены порядковый номер вопроса в тестах, цветами разделены итерации прохождения тестирования*

В случае, если пользователь всегда отвечает верно и не допускает ошибок, при первом запуске тренажера ему будут показаны 15 вопросов с типами с 1 по 5, касающиеся первых 3 блюд, добавленных для изучения. При следующем запуске будут показаны вопросы этих же типов для следующих 3 блюд.

После прохождения трех тестов с типами вопросов с 1 по 5, пользователю должен быть предложен тест с вопросами типов 6-10 для первых трех блюд. Переход к изучению следующих 9 блюд в списке для изучения, должен осуществляться только после того, как будут даны верные ответы на все 90 вопросов блока.

В случае, если для изучения было добавлено меньшее количество блюд, то в тесте все равно сперва должны быть выведены вопросы типов 1-5.

![[Pasted image 20240923181608.png]]
*Распределение вопросов, если для изучения было добавлено 4 блюда*

![[Pasted image 20240923182243.png]]
*Распределение вопросов, если для изучения было добавлено 5 блюд*

### Ошибки при прохождении тестирования

В примере ниже, пользователь во время прохождения первого теста допустил ошибку в вопросах 3, 8 и 13. В результате, 3 вопрос (Выбери ингредиенты, Блюдо 1) должен быть показан еще один раз под номером 6, а 8 вопрос (Выбери ингредиенты, Блюдо 3) будет показан снова 11 по счету. Вместе с тем 13 вопрос (Выбери позицию по ингредиентам, Блюдо 2) будет показан при прохождении следующего теста, потому что в каждом тесте не может быть более 15 вопросов.

![[Pasted image 20240923182619.png]]
*При втором запуске тренажера, в тест будут добавлены вопросы не показанные в первый раз из-за допущенных ошибок. В скобках указан порядковый номер вопроса в тесте*

В случае, если пользователь снова допустит ошибку в вопросе из первого теста, то такой вопрос должен быть снова показан через два других.

В следующем примере, во время второго запуска тренажера, *первым* вопросом будет 13 из предыдущей попытки (Выбери позицию по ингредиентам, Блюдо 2), т. к. он не был показан пользователю в прошлый раз. Сотрудник снова совершает ошибку, вопрос будет показан повторно, *третьим* в текущей попытке и 19 по общему счету.

Также, в этом примере пользователь допускает ошибку в вопросе 21, который также будет показан повторно, *девятым* в этом тесте.

![[Pasted image 20240923183241.png]]
*Пользователь совершил ошибки в вопросах 16 и 21 во время второго запуска тренажера*

Ниже на изображении показано как будут распределены вопросы во время следующих запусков тренажера. В случае, если пользователь добавил к изучению несколько дополнительных блюд, вопросы, отмеченные белым будут добавлены к следующему запуску тренажера при изучении следующих позиций меню. Если в меню отсутствуют дополнительные позиции, будет составлен тест, содержащий только остаток этих вопросов.

![[Pasted image 20240923183644.png]]
*Распределение вопросов с учетом ошибок*

## Принципы формирования вопросов теста в тренажере

1. Тест в тренажере всегда состоит из 15 вопросов
2. Для того чтобы блюдо можно было добавить в тренажер, у него обязательно должно быть указано наименование, изображение, ингредиенты и описание
3. Для прохождения обучения на тренажере сотрудником в приложении должны быть обязательно добавлены минимум 3 блюда, потому что тестирование проводится сразу по 3 позициям меню. В случае, если для изучения добавлено меньшее количество блюд, должно выводиться сообщение с просьбой добавить еще несколько блюд
4. Всего существует 10 типов вопросов разной сложности, за которые начисляется разное количество процентов прогресса изучения блюда
5. Во время первого прохождения, в тесте присутствуют первые 5 типов вопросов для 3 разных блюд
6. При следующем запуске тренажера, в зависимости от ситуации, в тесте могут быть следующие типы вопросов:
	- Если для изучения были добавлены только 3 блюда - будут показаны вопросы с типом с 6 по 10 для этих блюд
	- Если для изучения добавлено большее количество блюд - будут показаны первые 5 типов вопросов для 3 следующих блюд
	- В случае, если список блюд для изучения не кратен 3 и меньше 6, то будут показаны первые 5 типов вопросов для следующих блюд и часть вопросов с типом с 6 по 10 первой тройки блюд
7. В случае, если сотрудник при прохождении теста допустил ошибку, то этот же вопрос будет повторен в тесте через 2 вопроса, но количество вопросов в тесте все равно не изменится. Их также будет 15
	- Вопросы, которые не были показаны пользователю во время прохождения теста (были замещены вопросами с ошибками в ответе), должны быть показаны при следующем запуске тренажера.
	- Пользователь может пропустить вопрос, в таком случае, он также будет повторен еще раз через два вопроса
8. Если сотрудник добавил для изучения более 9 блюд, вопросы, касающиеся следующих позиций меню (с 10 и далее) не будут показаны, пока не будут правильно отвечены вопросы всех типов для первых 9 блюд
	- В случае, если при изучении первых 9 блюд у сотрудника осталось несколько не отвеченных вопросов, которых не хватает для составления полноценного теста из 15 вопросов, то должен быть сформирован новый тест, в который будут включены вопросы с неверными ответами и вопросы, касающиеся следующих блюд, начиная с 10 в списке для изучения
	- Если у пользователя остались вопросы с ошибочными ответами, но в меню больше нет блюд для составления полноценного теста из 15 вопросов, будет составлен тест только с теми вопросами, на которые дан неверный ответ
9. Блюдо считается изученным, если были даны верные ответы на все типы вопросов
10. Пользователь может допустить 3 ошибки во время прохождения теста