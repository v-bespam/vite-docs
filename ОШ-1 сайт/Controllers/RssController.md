---
date: 2024-09-30
tags:
  - ОШ-1-сайт
---
Контроллер предназначен для генерация и отправки RSS ленты

### Endpoints

Контроллер предоставляет следующие эндпоинты:

| Метод | URL                  | Описание                                                                    |
| ----- | -------------------- | --------------------------------------------------------------------------- |
| GET   | `nest/api/rss`       | [[#Формирование RSS ленты\|Формирование RSS ленты]]                         |
| GET   | `nest/api/rss/turbo` | [[#Получение RSS ленты турбо страницы\|Получение RSS ленты турбо страницы]] |

### Формирование RSS ленты

`GET nest/api/rss`

*Входные данные:* Отсутствуют

*Функционал:*

Выполняет поиск в кэше Redis по ключу `news`, если данные не найдены, выполняет запрос к Strapi для получения коллекции SchoolNews (API ID: school-news) с сортировкой в порядке уменьшения (первыми в списке будут последние новости). Для получения всех новостей offset  равен 0, а limit  -1. Формирует RSS ленту новостей сайта в формате XML.

*Выходные данные:* Status: `200 OK`

Возвращает сгенерированный RSS-канал в формате XML, который содержит следующую информацию:

- Заголовок канала, ссылку на сайт и описание.
- Список новостей, каждая из которых представлена элементом `<item>`, содержащим заголовок, ссылку, описание, дату публикации и, при наличии, изображение.

## Получение RSS ленты турбо страницы

`GET nest/api/rss/turbo`

*Входные данные:*

- Query параметры:

| Параметр | Тип данных | Валидация    | Описание                 |
| -------- | ---------- | ------------ | ------------------------ |
| paged    | string     | Опциональный | Номер страницы RSS ленты |

*Функционал:*

В соответствии с переданным параметром в запросе, формирует RSS ленту для указанной страницы в формате XML. По умолчанию параметр `paged` равен 1, количество новостей на странице - 10.

При возникновении ошибки выводит в консоль сообщение "Error reading or parsing RSS feed:" с текстом ошибки, а также выбрасывает исключение Error с сообщением "Failed to retrieve RSS feed.".

*Выходные данные:* Status: `200 OK`