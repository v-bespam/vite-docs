---
date: 2024-09-30
tags:
  - ОШ-1-сайт
---
Контроллер предназначен для выполнения запроса к API Unisender для сохранения адреса электронной почты в списке рассылки.

### Endpoints

Контроллер предоставляет следующий эндпоинт:

| Метод | URL                            | Описание                                        |
| ----- | ------------------------------ | ----------------------------------------------- |
| POST  | `nest/api/subscription/email/` | [[#Подписка на рассылку\|Подписка на рассылку]] |

### Подписка на рассылку

`POST nest/api/subscription/email/`

*Входные данные:*

- В тело запроса должны быть переданы следующие параметры:

| Параметр | Тип данных | Валидация    | Описание                |
| -------- | ---------- | ------------ | ----------------------- |
| email    | string     | Обязательный | Адрес электронной почты |

*Функционал:*

Отправляет GET запрос к API Unisender https://api.unisender.com/ru/api/subscribe, содержащий следующую информацию:

```json
{
  format: 'json',
  api_key: process.env.UNISENDER_API_KEY,
  list_ids: '1',
  double_optin: 3,
  'fields[email]': dto.email,
};
```

Если при выполнении запроса возникает ошибка выбрасывается исключение BadRequestException с сообщением об ошибке.

*Выходные данные:*

Возвращает результат отправки запроса к API Unisender.