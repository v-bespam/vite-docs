---
date: 2024-10-01
tags:
  - ОШ-1-сайт
---
Формирование sitemap организовано при помощи модуля @nuxtjs/sitemap на фронтенде.

Выполняется GET запрос к бэкенду Nest.JS по пути `nest/api/pages/sitemap/`, который возвращает данные о страницах для включения в sitemap. Nest.JS сперва выполняет поиск информации в кэше Redis, а при ее отсутствии обращается за списком страниц к Strapi. [[PageController#Получение sitemap|Подробнее]]

Затем, полученный массив обрабатывается - для каждой страницы создается объект `route`, который содержит:

- URL страницы
- частота изменения страницы (по умолчанию 'weekly')
- приоритет страницы (по умолчанию 0.8)
- дата последнего изменения страницы

Если у страницы в массиве присутствует свойство `sitemapConfig` (задается в Strapi), то данные для `route` о частоте изменений и приоритете изменены не будут.

В конце возвращает объект с конфигурацией sitemap:

```json
{
  path: 'sitemap.xml',
  cacheTime: 1000 * 60 * 60 * 12, // 12 hours
  hostname: process.env.SITE_URL,
  trailingSlash: true,
  exclude: ['thanks', '_icons', ''],
  routes
}
```